Homework 5
================
Ziyu Chen
11/19/2021

\#R setup

``` r
library(readxl)
library(tidyverse)
```

# Problem 1 (0 point)

-   Read in the data

``` r
murder_raw = 
  read_csv(url("https://github.com/washingtonpost/data-homicides/raw/master/homicide-data.csv")) 
```

Murder\_df has 52179 observations and 12 variables, including city,
city\_state, disposition, lat, lon, reported\_date, state, uid,
victim\_age, victim\_first, victim\_last, victim\_race, victim\_sex.
This dataset contains information about homicide cases in the United
States.

-   Create the city\_state variable, find the murders count within the
    city\_

``` r
murder_new = murder_raw %>%
   mutate(city_state = str_c(city, state, sep = ", ")) %>%
  group_by(city_state) %>%
   subset(city_state != "Tulsa, AL")


murder_total=
murder_new %>%
  group_by(city_state) %>%
  summarise(total = n())

murder_unsolved =
  murder_new %>%
  filter(disposition %in% c("Closed without arrest","Open/no arrest")) %>%
  group_by(city_state) %>%
  summarise(unsolved = n())

final = merge(murder_total, murder_unsolved, by = "city_state")
  
  knitr::kable(final [1:10, ]) #showing the only first ten rows to make sure that the data are correct
```

| city\_state     | total | unsolved |
|:----------------|------:|---------:|
| Albuquerque, NM |   378 |       52 |
| Atlanta, GA     |   973 |       58 |
| Baltimore, MD   |  2827 |      152 |
| Baton Rouge, LA |   424 |       16 |
| Birmingham, AL  |   800 |       64 |
| Buffalo, NY     |   521 |        8 |
| Charlotte, NC   |   687 |       44 |
| Chicago, IL     |  5535 |      387 |
| Cincinnati, OH  |   694 |       49 |
| Columbus, OH    |  1084 |       80 |

The final table will have information the total and unsolved cases for
cities in the US.

-   prop.test function on baltimore

``` r
prop.test(
    x=murder_unsolved %>% 
    filter(city_state == "Baltimore, MD") %>%
    pull(unsolved),
    n=murder_total %>%
    filter(city_state == "Baltimore, MD") %>%
    pull(total)) %>%
  broom::tidy()                
```

    ## # A tibble: 1 × 8
    ##   estimate statistic p.value parameter conf.low conf.high method     alternative
    ##      <dbl>     <dbl>   <dbl>     <int>    <dbl>     <dbl> <chr>      <chr>      
    ## 1   0.0538     2250.       0         1   0.0459    0.0629 1-sample … two.sided

# Problem 2,
